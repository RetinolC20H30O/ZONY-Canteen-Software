<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horwang Canteen - ระบบจัดการร้านค้า</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        window.react = window.React;
        window.reactDOM = window.ReactDOM;
    </script>
    <script src="https://unpkg.com/lucide-react@0.292.0/dist/umd/lucide-react.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Kanit', sans-serif;
        }

        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }

        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse-dot {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.4;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease-out forwards;
        }

        .pulse-dot {
            animation: pulse-dot 1.5s ease-in-out infinite;
        }

        .glass {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .stat-card {
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // --- Icons ---
        let Icons = {};
        const iconFallback = ({ name, ...p }) => <span {...p} style={{ display: 'inline-block', width: '20px', height: '20px', background: '#ccc', borderRadius: '4px', textAlign: 'center', lineHeight: '20px', fontSize: '10px' }}>?</span>;
        const iconNames = ['Search', 'ShoppingCart', 'User', 'Home', 'ArrowLeft', 'Star', 'Clock', 'CreditCard', 'ChevronRight', 'MapPin', 'Utensils', 'Package', 'TrendingUp', 'CheckCircle', 'XCircle', 'Edit3', 'Plus', 'Minus', 'Trash2', 'Bell', 'Settings', 'LogOut', 'BarChart3', 'ChefHat', 'Eye', 'EyeOff', 'Save', 'X', 'AlertCircle', 'DollarSign', 'Users', 'ShoppingBag', 'ClipboardList', 'Timer', 'Hash', 'Store', 'Menu', 'RefreshCw'];
        if (typeof LucideReact !== 'undefined') { Icons = LucideReact; } else { iconNames.forEach(n => { Icons[n] = (p) => iconFallback({ name: n, ...p }); }); }
        const { Search, ShoppingCart, User, Home, ArrowLeft, Star, Clock, CreditCard, ChevronRight, MapPin, Utensils, Package, TrendingUp, CheckCircle, XCircle, Edit3, Plus, Minus, Trash2, Bell, Settings, LogOut, BarChart3, ChefHat, Eye, EyeOff, Save, X, AlertCircle, DollarSign, Users, ShoppingBag, ClipboardList, Timer, Hash, Store, Menu: MenuIcon, RefreshCw } = Icons;

        // --- Shop Lookup (1-32) ---
        const allShops = {
            1: 'ร้านน้ำสวัสดิการ', 2: 'มาลี ก๋วยเตี๋ยวไก่', 3: 'ก๋วยเตี๋ยวต้มยำ',
            4: 'พระข้าวราดแกง', 5: 'ข้าวราดแกง', 6: 'พรผลไม้',
            7: 'สุกี้ - ราดหน้า', 8: 'นันทวรรณก๋วยเตี๋ยวเรือ', 9: 'โฉมยง ขนมหวาน',
            10: 'อารีนัน ก๋วยเตี๋ยวต้มยำ', 11: 'ก๋วยเตี๋ยวหมูละมุน', 12: 'ข้าวมันไก่ป้าติ๋ม',
            13: 'ชุติมา อาหารตามสั่ง', 14: 'ฐิตืพงศ์ ก๋วยจั๊บ', 15: 'ป้าอัจ ก๋วยเตี๋ยวหมูเด้ง',
            16: 'จุ้บแจง อาหารตามสั่ง', 17: 'หอยทอดฮ่องกง', 18: 'ปูเปรี้ยวส้มตำ',
            19: 'เบเกอรี่ ปังปัง', 20: 'Juicy Delight', 21: 'หมูทอดทงคัตสึไฮคิว',
            22: 'ข้าวไข่เจียวบุฟเฟ่ต์', 23: 'กินข้าวแกง by พี่ก้อย', 24: 'อาหารนานาชาติ',
            25: 'คอนร์ด็อก', 26: 'กัสโมส ข้าวไก่อบ ไก่ราซอส', 27: 'ลูกชิ้นอร่อยจัง',
            28: 'ธนะสิทธ์ โจ๊ก ข้าวต้ม ต้มเลือดหมู', 29: 'อุษา ข้าวขาหมู ข้าวหมูแดง',
            30: 'นิจวิภา ไอศกรีม', 31: 'ฟุตบอลไข่ข้น', 32: 'ไก่ย่างห้าดาว',
        };

        // --- Mock Data ---
        const mockMenu = [
            { id: 1, name: 'ก๋วยเตี๋ยวเรือหมู', price: 40, image: 'https://images.unsplash.com/photo-1596450519634-c941d24a9058?auto=format&fit=crop&q=80&w=300', available: true, category: 'noodle', sold: 45 },
            { id: 2, name: 'ก๋วยเตี๋ยวเรือเนื้อ', price: 50, image: 'https://images.unsplash.com/photo-1569562211093-4ed0d0758f12?auto=format&fit=crop&q=80&w=300', available: true, category: 'noodle', sold: 32 },
            { id: 3, name: 'เกาเหลาหมู', price: 50, image: 'https://images.unsplash.com/photo-1552611052-33e04de081de?auto=format&fit=crop&q=80&w=300', available: true, category: 'noodle', sold: 28 },
            { id: 4, name: 'เส้นเล็กต้มยำ', price: 40, image: 'https://images.unsplash.com/photo-1569562211093-4ed0d0758f12?auto=format&fit=crop&q=80&w=300', available: false, category: 'noodle', sold: 15 },
            { id: 5, name: 'บะหมี่แห้งหมูแดง', price: 45, image: 'https://images.unsplash.com/photo-1617093727343-374698b1b08d?auto=format&fit=crop&q=80&w=300', available: true, category: 'noodle', sold: 38 },
        ];

        const mockOrders = [
            { id: 'A-001', studentId: '67001', studentName: 'ด.ช. สมชาย เรียนดี', items: [{ name: 'ก๋วยเตี๋ยวเรือหมู', qty: 1, price: 40 }, { name: 'เกาเหลาหมู', qty: 1, price: 50 }], total: 90, status: 'new', time: '11:32', note: 'ไม่ใส่ถั่วงอก' },
            { id: 'A-002', studentId: '67015', studentName: 'ด.ญ. สมหญิง ตั้งใจ', items: [{ name: 'ก๋วยเตี๋ยวเรือเนื้อ', qty: 2, price: 50 }], total: 100, status: 'new', time: '11:33', note: '' },
            { id: 'A-003', studentId: '67022', studentName: 'ด.ช. วีรภัทร ใจดี', items: [{ name: 'บะหมี่แห้งหมูแดง', qty: 1, price: 45 }], total: 45, status: 'cooking', time: '11:28', note: 'เพิ่มหมูแดง' },
            { id: 'A-004', studentId: '67008', studentName: 'ด.ญ. พิมพ์ชนก สว่าง', items: [{ name: 'ก๋วยเตี๋ยวเรือหมู', qty: 1, price: 40 }, { name: 'ก๋วยเตี๋ยวเรือเนื้อ', qty: 1, price: 50 }], total: 90, status: 'cooking', time: '11:25', note: '' },
            { id: 'A-005', studentId: '67030', studentName: 'ด.ช. ธนกฤต มั่นคง', items: [{ name: 'เกาเหลาหมู', qty: 1, price: 50 }], total: 50, status: 'ready', time: '11:20', note: '' },
            { id: 'A-006', studentId: '67045', studentName: 'ด.ญ. ปภาวี รุ่งเรือง', items: [{ name: 'ก๋วยเตี๋ยวเรือหมู', qty: 2, price: 40 }], total: 80, status: 'completed', time: '11:15', note: '' },
            { id: 'A-007', studentId: '67012', studentName: 'ด.ช. ภูวดล แสงทอง', items: [{ name: 'บะหมี่แห้งหมูแดง', qty: 1, price: 45 }, { name: 'เกาเหลาหมู', qty: 1, price: 50 }], total: 95, status: 'completed', time: '11:10', note: '' },
            { id: 'A-008', studentId: '67055', studentName: 'ด.ญ. กัญญาภัค พงศ์ไพร', items: [{ name: 'ก๋วยเตี๋ยวเรือเนื้อ', qty: 1, price: 50 }], total: 50, status: 'completed', time: '11:05', note: '' },
        ];

        // --- Login Screen ---
        const LoginScreen = ({ onLogin }) => {
            const [shopCode, setShopCode] = useState('');
            const handleLogin = () => {
                const num = parseInt(shopCode);
                if (num >= 1 && num <= 32) {
                    onLogin(num);
                } else {
                    alert('กรุณากรอกเลขร้านค้า 1-32');
                }
            };
            return (
                <div className="min-h-screen bg-gradient-to-br from-[#3E2723] via-[#5D4037] to-[#4E342E] flex flex-col items-center justify-center p-6 relative overflow-hidden">
                    <div className="absolute top-20 left-10 w-72 h-72 bg-amber-500/10 rounded-full blur-3xl"></div>
                    <div className="absolute bottom-20 right-10 w-96 h-96 bg-amber-600/8 rounded-full blur-3xl"></div>
                    <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-amber-400/5 rounded-full blur-3xl"></div>
                    <div className="glass p-10 rounded-3xl w-full max-w-sm shadow-2xl relative z-10 animate-slide-up">
                        <div className="flex justify-center mb-4">
                            <div className="w-16 h-16 bg-gradient-to-br from-amber-400 to-amber-600 rounded-2xl flex items-center justify-center shadow-lg shadow-amber-500/30">
                                <Store size={32} className="text-white" />
                            </div>
                        </div>
                        <h1 className="text-2xl font-bold text-white text-center mb-1">ระบบร้านค้า</h1>
                        <p className="text-amber-200/70 text-center mb-8 text-sm">Horwang School Canteen — Shop Panel</p>
                        <div className="space-y-4">
                            <div className="relative">
                                <Hash className="absolute left-4 top-3.5 text-gray-400 w-5 h-5" />
                                <input type="number" min="1" max="32" placeholder="เลขร้านค้า (1-32)" className="w-full pl-12 pr-4 py-3.5 rounded-xl bg-white/90 text-gray-800 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-amber-400 font-medium tracking-wide" value={shopCode} onChange={(e) => setShopCode(e.target.value)} />
                            </div>
                            <button onClick={handleLogin} className="w-full py-3.5 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 text-white font-semibold hover:from-amber-600 hover:to-amber-700 transition-all active:scale-[0.98] shadow-lg shadow-amber-500/30 flex items-center justify-center gap-2">
                                เข้าสู่ระบบ <ChevronRight size={20} />
                            </button>
                        </div>
                    </div>
                    <p className="absolute bottom-6 text-white/30 text-xs">© 2026 Horwang Digital Canteen © ZONY</p>
                </div>
            );
        };

        // --- Stat Card ---
        const StatCard = ({ icon: Icon, label, value, color, sub }) => (
            <div className={`stat-card bg-white rounded-2xl p-4 shadow-sm border border-gray-100`}>
                <div className="flex items-center gap-3 mb-2">
                    <div className={`w-10 h-10 rounded-xl flex items-center justify-center ${color}`}><Icon size={20} className="text-white" /></div>
                    <span className="text-xs text-gray-500 font-medium">{label}</span>
                </div>
                <p className="text-2xl font-bold text-gray-800">{value}</p>
                {sub && <p className="text-xs text-gray-400 mt-1">{sub}</p>}
            </div>
        );

        // --- Order Card ---
        const OrderCard = ({ order, onAction }) => {
            const statusConfig = {
                new: { label: 'ออเดอร์ใหม่', bg: 'bg-red-50', border: 'border-red-200', dot: 'bg-red-500', text: 'text-red-700' },
                cooking: { label: 'กำลังทำ', bg: 'bg-amber-50', border: 'border-amber-200', dot: 'bg-amber-500', text: 'text-amber-700' },
                ready: { label: 'พร้อมเสิร์ฟ', bg: 'bg-green-50', border: 'border-green-200', dot: 'bg-green-500', text: 'text-green-700' },
                completed: { label: 'เสร็จสิ้น', bg: 'bg-gray-50', border: 'border-gray-200', dot: 'bg-gray-400', text: 'text-gray-500' },
            };
            const s = statusConfig[order.status];
            return (
                <div className={`${s.bg} border ${s.border} rounded-2xl p-4 animate-fade-in`}>
                    <div className="flex justify-between items-start mb-3">
                        <div>
                            <div className="flex items-center gap-2">
                                <span className="font-bold text-lg text-gray-800">{order.id}</span>
                                <span className={`px-2 py-0.5 rounded-full text-[10px] font-semibold ${s.text} ${s.bg} border ${s.border} flex items-center gap-1`}>
                                    <span className={`w-1.5 h-1.5 rounded-full ${s.dot} ${order.status === 'new' ? 'pulse-dot' : ''}`}></span>{s.label}
                                </span>
                            </div>
                            <p className="text-sm text-gray-600 mt-0.5">{order.studentName}</p>
                        </div>
                        <div className="text-right">
                            <p className="text-xs text-gray-400 flex items-center gap-1"><Clock size={10} />{order.time}</p>
                            <p className="font-bold text-[#5D4037] text-lg">฿{order.total}</p>
                        </div>
                    </div>
                    <div className="bg-white/70 rounded-xl p-3 mb-3">
                        {order.items.map((item, i) => (
                            <div key={i} className="flex justify-between text-sm py-1">
                                <span className="text-gray-700">{item.qty}x {item.name}</span>
                                <span className="text-gray-500">฿{item.price * item.qty}</span>
                            </div>
                        ))}
                        {order.note && <div className="mt-2 pt-2 border-t border-dashed border-gray-200 text-xs text-amber-700 flex items-start gap-1"><AlertCircle size={12} className="mt-0.5 flex-shrink-0" />{order.note}</div>}
                    </div>
                    <div className="flex gap-2">
                        {order.status === 'new' && (<>
                            <button onClick={() => onAction(order.id, 'cooking')} className="flex-1 py-2.5 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 text-white text-sm font-semibold flex items-center justify-center gap-1 hover:shadow-md transition-all active:scale-[0.97]"><ChefHat size={16} />รับออเดอร์</button>
                            <button onClick={() => onAction(order.id, 'cancelled')} className="py-2.5 px-4 rounded-xl bg-white border border-red-200 text-red-500 text-sm font-semibold hover:bg-red-50 transition-all active:scale-[0.97]"><XCircle size={16} /></button>
                        </>)}
                        {order.status === 'cooking' && <button onClick={() => onAction(order.id, 'ready')} className="flex-1 py-2.5 rounded-xl bg-gradient-to-r from-green-500 to-emerald-600 text-white text-sm font-semibold flex items-center justify-center gap-1 hover:shadow-md transition-all active:scale-[0.97]"><CheckCircle size={16} />ทำเสร็จแล้ว</button>}
                        {order.status === 'ready' && <button onClick={() => onAction(order.id, 'completed')} className="flex-1 py-2.5 rounded-xl bg-gradient-to-r from-blue-500 to-blue-600 text-white text-sm font-semibold flex items-center justify-center gap-1 hover:shadow-md transition-all active:scale-[0.97]"><Package size={16} />ส่งมอบแล้ว</button>}
                        {order.status === 'completed' && <div className="flex-1 py-2.5 rounded-xl bg-gray-100 text-gray-400 text-sm text-center font-medium">เสร็จสมบูรณ์ ✓</div>}
                    </div>
                </div>
            );
        };

        // --- Main App ---
        function App() {
            const [loggedIn, setLoggedIn] = useState(false);
            const [shopId, setShopId] = useState(null);
            const [tab, setTab] = useState('dashboard');
            const [orders, setOrders] = useState(mockOrders);
            const [menu, setMenu] = useState(mockMenu);
            const [orderFilter, setOrderFilter] = useState('all');
            const [showAddMenu, setShowAddMenu] = useState(false);
            const [newItem, setNewItem] = useState({ name: '', price: '', category: 'noodle' });
            const [editingItem, setEditingItem] = useState(null);

            const shopInfo = { name: allShops[shopId] || 'ร้านค้า', id: `S-${String(shopId).padStart(3, '0')}`, zone: shopId <= 11 ? 'โซน A' : shopId <= 22 ? 'โซน B' : 'โซน C' };

            const handleOrderAction = (id, newStatus) => {
                if (newStatus === 'cancelled') { setOrders(prev => prev.filter(o => o.id !== id)); return; }
                setOrders(prev => prev.map(o => o.id === id ? { ...o, status: newStatus } : o));
            };

            const toggleAvailability = (id) => setMenu(prev => prev.map(m => m.id === id ? { ...m, available: !m.available } : m));

            const addMenuItem = () => {
                if (!newItem.name || !newItem.price) return alert('กรุณากรอกข้อมูลให้ครบ');
                setMenu(prev => [...prev, { id: Date.now(), name: newItem.name, price: parseInt(newItem.price), image: 'https://images.unsplash.com/photo-1596450519634-c941d24a9058?auto=format&fit=crop&q=80&w=300', available: true, category: newItem.category, sold: 0 }]);
                setNewItem({ name: '', price: '', category: 'noodle' });
                setShowAddMenu(false);
            };

            const deleteMenuItem = (id) => { if (confirm('ลบเมนูนี้?')) setMenu(prev => prev.filter(m => m.id !== id)); };

            const saveEdit = () => {
                if (!editingItem) return;
                setMenu(prev => prev.map(m => m.id === editingItem.id ? editingItem : m));
                setEditingItem(null);
            };

            const newOrders = orders.filter(o => o.status === 'new').length;
            const cookingOrders = orders.filter(o => o.status === 'cooking').length;
            const todayRevenue = orders.filter(o => o.status === 'completed').reduce((s, o) => s + o.total, 0);
            const totalSold = orders.filter(o => o.status === 'completed').reduce((s, o) => s + o.items.reduce((a, i) => a + i.qty, 0), 0);
            const filteredOrders = orderFilter === 'all' ? orders.filter(o => o.status !== 'completed') : orders.filter(o => o.status === orderFilter);

            if (!loggedIn) return <LoginScreen onLogin={(num) => { setShopId(num); setLoggedIn(true); }} />;

            return (
                <div className="bg-gray-50 min-h-screen pb-24 max-w-lg mx-auto relative shadow-2xl">
                    {/* Header */}
                    <header className="bg-gradient-to-r from-[#4E342E] to-[#5D4037] text-white p-4 sticky top-0 z-20 shadow-lg rounded-b-2xl">
                        <div className="flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="w-11 h-11 bg-gradient-to-br from-amber-400 to-amber-600 rounded-xl flex items-center justify-center shadow-md"><Store size={22} className="text-white" /></div>
                                <div>
                                    <h2 className="font-bold text-base leading-tight">{shopInfo.name}</h2>
                                    <p className="text-amber-300/80 text-xs">{shopInfo.id} • {shopInfo.zone}</p>
                                </div>
                            </div>
                            <div className="flex items-center gap-3">
                                <div className="relative cursor-pointer" onClick={() => setTab('orders')}>
                                    <Bell size={22} />
                                    {newOrders > 0 && <span className="absolute -top-1 -right-1 bg-red-500 text-[10px] w-4 h-4 flex items-center justify-center rounded-full font-bold border-2 border-[#5D4037] pulse-dot">{newOrders}</span>}
                                </div>
                                <button onClick={() => { setLoggedIn(false); }} className="p-2 rounded-lg hover:bg-white/10 transition-colors"><LogOut size={20} /></button>
                            </div>
                        </div>
                    </header>

                    <main className="p-4">
                        {/* Dashboard */}
                        {tab === 'dashboard' && (
                            <div className="animate-fade-in space-y-5">
                                <div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2"><BarChart3 size={20} className="text-[#5D4037]" />สรุปวันนี้</h3>
                                    <div className="grid grid-cols-2 gap-3">
                                        <StatCard icon={DollarSign} label="รายได้วันนี้" value={`฿${todayRevenue}`} color="bg-gradient-to-br from-green-400 to-emerald-600" sub={`${orders.filter(o => o.status === 'completed').length} ออเดอร์สำเร็จ`} />
                                        <StatCard icon={ShoppingBag} label="ขายได้" value={`${totalSold} จาน`} color="bg-gradient-to-br from-blue-400 to-blue-600" sub="อัพเดทอัตโนมัติ" />
                                        <StatCard icon={ClipboardList} label="รอดำเนินการ" value={newOrders + cookingOrders} color="bg-gradient-to-br from-amber-400 to-orange-500" sub={`${newOrders} ใหม่ • ${cookingOrders} กำลังทำ`} />
                                        <StatCard icon={Utensils} label="เมนูเปิดขาย" value={`${menu.filter(m => m.available).length}/${menu.length}`} color="bg-gradient-to-br from-purple-400 to-purple-600" sub="เมนูที่พร้อมขาย" />
                                    </div>
                                </div>

                                {/* Recent new orders */}
                                {newOrders > 0 && (
                                    <div>
                                        <div className="flex justify-between items-center mb-3">
                                            <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2"><Bell size={20} className="text-red-500" />ออเดอร์ใหม่ <span className="bg-red-500 text-white text-xs px-2 py-0.5 rounded-full">{newOrders}</span></h3>
                                            <button onClick={() => { setTab('orders'); setOrderFilter('new'); }} className="text-sm text-[#5D4037] font-medium hover:underline">ดูทั้งหมด</button>
                                        </div>
                                        <div className="space-y-3">
                                            {orders.filter(o => o.status === 'new').slice(0, 2).map(o => <OrderCard key={o.id} order={o} onAction={handleOrderAction} />)}
                                        </div>
                                    </div>
                                )}

                                {/* Top selling */}
                                <div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-3 flex items-center gap-2"><TrendingUp size={20} className="text-amber-500" />เมนูขายดี</h3>
                                    <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                        {[...menu].sort((a, b) => b.sold - a.sold).slice(0, 3).map((item, i) => (
                                            <div key={item.id} className={`flex items-center gap-3 p-3 ${i > 0 ? 'border-t border-gray-50' : ''}`}>
                                                <span className={`w-7 h-7 rounded-lg flex items-center justify-center text-sm font-bold ${i === 0 ? 'bg-amber-100 text-amber-600' : i === 1 ? 'bg-gray-100 text-gray-500' : 'bg-orange-50 text-orange-400'}`}>{i + 1}</span>
                                                <img src={item.image} className="w-10 h-10 rounded-lg object-cover" alt="" />
                                                <div className="flex-1">
                                                    <p className="font-semibold text-sm text-gray-800">{item.name}</p>
                                                    <p className="text-xs text-gray-400">฿{item.price}</p>
                                                </div>
                                                <span className="text-sm font-bold text-[#5D4037]">{item.sold} จาน</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Orders */}
                        {tab === 'orders' && (
                            <div className="animate-fade-in space-y-4">
                                <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2"><ClipboardList size={20} className="text-[#5D4037]" />จัดการออเดอร์</h3>
                                <div className="flex gap-2 overflow-x-auto scrollbar-hide pb-1">
                                    {[{ k: 'all', l: 'ทั้งหมด' }, { k: 'new', l: `ใหม่ (${newOrders})` }, { k: 'cooking', l: `กำลังทำ (${cookingOrders})` }, { k: 'ready', l: `พร้อมเสิร์ฟ (${orders.filter(o => o.status === 'ready').length})` }, { k: 'completed', l: 'เสร็จสิ้น' }].map(f => (
                                        <button key={f.k} onClick={() => setOrderFilter(f.k)} className={`flex-shrink-0 px-4 py-2 rounded-full text-sm font-medium transition-colors whitespace-nowrap ${orderFilter === f.k ? 'bg-[#5D4037] text-white shadow-md' : 'bg-white text-gray-600 border border-gray-200 hover:border-gray-300'}`}>{f.l}</button>
                                    ))}
                                </div>
                                <div className="space-y-3">
                                    {(orderFilter === 'all' ? orders.filter(o => o.status !== 'completed') : orders.filter(o => o.status === orderFilter)).length === 0 ? (
                                        <div className="text-center py-16 text-gray-400"><CheckCircle size={40} className="mx-auto mb-3 text-gray-300" /><p className="font-medium">ไม่มีออเดอร์ในหมวดนี้</p></div>
                                    ) : (
                                        (orderFilter === 'all' ? orders.filter(o => o.status !== 'completed') : orders.filter(o => o.status === orderFilter)).map(o => <OrderCard key={o.id} order={o} onAction={handleOrderAction} />)
                                    )}
                                </div>
                            </div>
                        )}

                        {/* Menu Management */}
                        {tab === 'menu' && (
                            <div className="animate-fade-in space-y-4">
                                <div className="flex justify-between items-center">
                                    <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2"><Utensils size={20} className="text-[#5D4037]" />จัดการเมนู</h3>
                                    <button onClick={() => setShowAddMenu(true)} className="px-4 py-2 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 text-white text-sm font-semibold flex items-center gap-1 hover:shadow-md transition-all active:scale-[0.97]"><Plus size={16} />เพิ่มเมนู</button>
                                </div>

                                {/* Add Menu Modal */}
                                {showAddMenu && (
                                    <div className="fixed inset-0 bg-black/50 flex items-end justify-center z-50" onClick={(e) => { if (e.target === e.currentTarget) setShowAddMenu(false); }}>
                                        <div className="bg-white rounded-t-3xl p-6 w-full max-w-lg animate-slide-up">
                                            <div className="flex justify-between items-center mb-4">
                                                <h3 className="text-lg font-bold text-gray-800">เพิ่มเมนูใหม่</h3>
                                                <button onClick={() => setShowAddMenu(false)} className="p-1 hover:bg-gray-100 rounded-full"><X size={20} /></button>
                                            </div>
                                            <div className="space-y-3">
                                                <input type="text" placeholder="ชื่อเมนู" className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-400 text-sm" value={newItem.name} onChange={e => setNewItem({ ...newItem, name: e.target.value })} />
                                                <input type="number" placeholder="ราคา (บาท)" className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-400 text-sm" value={newItem.price} onChange={e => setNewItem({ ...newItem, price: e.target.value })} />
                                                <select className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-400 text-sm bg-white" value={newItem.category} onChange={e => setNewItem({ ...newItem, category: e.target.value })}>
                                                    <option value="noodle">ก๋วยเตี๋ยว</option><option value="rice">ข้าว</option><option value="snack">ของทานเล่น</option><option value="drink">เครื่องดื่ม</option>
                                                </select>
                                                <button onClick={addMenuItem} className="w-full py-3 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 text-white font-semibold hover:shadow-md transition-all active:scale-[0.98] flex items-center justify-center gap-2"><Save size={18} />บันทึกเมนู</button>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Edit Menu Modal */}
                                {editingItem && (
                                    <div className="fixed inset-0 bg-black/50 flex items-end justify-center z-50" onClick={(e) => { if (e.target === e.currentTarget) setEditingItem(null); }}>
                                        <div className="bg-white rounded-t-3xl p-6 w-full max-w-lg animate-slide-up">
                                            <div className="flex justify-between items-center mb-4">
                                                <h3 className="text-lg font-bold text-gray-800">แก้ไขเมนู</h3>
                                                <button onClick={() => setEditingItem(null)} className="p-1 hover:bg-gray-100 rounded-full"><X size={20} /></button>
                                            </div>
                                            <div className="space-y-3">
                                                <input type="text" className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-400 text-sm" value={editingItem.name} onChange={e => setEditingItem({ ...editingItem, name: e.target.value })} />
                                                <input type="number" className="w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-amber-400 text-sm" value={editingItem.price} onChange={e => setEditingItem({ ...editingItem, price: parseInt(e.target.value) || 0 })} />
                                                <button onClick={saveEdit} className="w-full py-3 rounded-xl bg-gradient-to-r from-amber-500 to-amber-600 text-white font-semibold hover:shadow-md transition-all active:scale-[0.98] flex items-center justify-center gap-2"><Save size={18} />บันทึกการแก้ไข</button>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Menu List */}
                                <div className="space-y-3">
                                    {menu.map(item => (
                                        <div key={item.id} className={`bg-white rounded-2xl p-4 shadow-sm border ${item.available ? 'border-gray-100' : 'border-red-100 opacity-70'} transition-all`}>
                                            <div className="flex gap-3">
                                                <img src={item.image} className="w-20 h-20 rounded-xl object-cover bg-gray-100" alt="" />
                                                <div className="flex-1">
                                                    <div className="flex justify-between items-start">
                                                        <div>
                                                            <h4 className="font-bold text-gray-800">{item.name}</h4>
                                                            <p className="text-[#5D4037] font-bold text-lg">฿{item.price}</p>
                                                        </div>
                                                        <span className={`px-2 py-0.5 rounded-full text-[10px] font-semibold ${item.available ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-600'}`}>{item.available ? 'เปิดขาย' : 'ปิดขาย'}</span>
                                                    </div>
                                                    <div className="flex items-center gap-2 mt-2">
                                                        <button onClick={() => toggleAvailability(item.id)} className={`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1 transition-colors ${item.available ? 'bg-red-50 text-red-600 hover:bg-red-100' : 'bg-green-50 text-green-600 hover:bg-green-100'}`}>
                                                            {item.available ? <><EyeOff size={12} />ปิดขาย</> : <><Eye size={12} />เปิดขาย</>}
                                                        </button>
                                                        <button onClick={() => setEditingItem({ ...item })} className="px-3 py-1.5 rounded-lg text-xs font-medium bg-blue-50 text-blue-600 hover:bg-blue-100 flex items-center gap-1"><Edit3 size={12} />แก้ไข</button>
                                                        <button onClick={() => deleteMenuItem(item.id)} className="px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-50 text-gray-500 hover:bg-gray-100 flex items-center gap-1"><Trash2 size={12} />ลบ</button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="mt-2 pt-2 border-t border-gray-50 flex justify-between text-xs text-gray-400">
                                                <span>ขายไปแล้ว {item.sold} จาน</span>
                                                <span>รายได้ ฿{item.sold * item.price}</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Sales */}
                        {tab === 'sales' && (
                            <div className="animate-fade-in space-y-5">
                                <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2"><TrendingUp size={20} className="text-[#5D4037]" />สรุปยอดขาย</h3>
                                <div className="bg-gradient-to-br from-[#5D4037] to-[#3E2723] rounded-2xl p-5 text-white shadow-lg">
                                    <p className="text-amber-200/70 text-sm mb-1">รายได้ทั้งหมดวันนี้</p>
                                    <p className="text-4xl font-bold">฿{todayRevenue}</p>
                                    <div className="flex gap-4 mt-4">
                                        <div className="bg-white/10 rounded-xl px-4 py-2 flex-1 text-center"><p className="text-amber-200 text-xs">ออเดอร์สำเร็จ</p><p className="text-xl font-bold">{orders.filter(o => o.status === 'completed').length}</p></div>
                                        <div className="bg-white/10 rounded-xl px-4 py-2 flex-1 text-center"><p className="text-amber-200 text-xs">จานทั้งหมด</p><p className="text-xl font-bold">{totalSold}</p></div>
                                        <div className="bg-white/10 rounded-xl px-4 py-2 flex-1 text-center"><p className="text-amber-200 text-xs">เฉลี่ย/ออเดอร์</p><p className="text-xl font-bold">฿{orders.filter(o => o.status === 'completed').length > 0 ? Math.round(todayRevenue / orders.filter(o => o.status === 'completed').length) : 0}</p></div>
                                    </div>
                                </div>

                                <div>
                                    <h4 className="font-bold text-gray-700 mb-3">ออเดอร์ที่เสร็จสิ้น</h4>
                                    <div className="space-y-2">
                                        {orders.filter(o => o.status === 'completed').length === 0 ? (
                                            <div className="text-center py-12 text-gray-400"><CheckCircle size={36} className="mx-auto mb-2 text-gray-300" /><p>ยังไม่มีออเดอร์ที่เสร็จสิ้น</p></div>
                                        ) : orders.filter(o => o.status === 'completed').map(o => (
                                            <div key={o.id} className="bg-white rounded-xl p-3 shadow-sm flex justify-between items-center border border-gray-100">
                                                <div className="flex items-center gap-3">
                                                    <div className="w-9 h-9 bg-green-100 rounded-lg flex items-center justify-center"><CheckCircle size={18} className="text-green-600" /></div>
                                                    <div><p className="font-semibold text-sm text-gray-800">{o.id}</p><p className="text-xs text-gray-400">{o.studentName} • {o.time}</p></div>
                                                </div>
                                                <span className="font-bold text-[#5D4037]">฿{o.total}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div>
                                    <h4 className="font-bold text-gray-700 mb-3">รายได้ตามเมนู</h4>
                                    <div className="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                                        {menu.map((item, i) => {
                                            const rev = item.sold * item.price;
                                            const maxRev = Math.max(...menu.map(m => m.sold * m.price));
                                            return (
                                                <div key={item.id} className={`p-3 ${i > 0 ? 'border-t border-gray-50' : ''}`}>
                                                    <div className="flex justify-between items-center mb-1">
                                                        <span className="text-sm font-medium text-gray-700">{item.name}</span>
                                                        <span className="text-sm font-bold text-[#5D4037]">฿{rev}</span>
                                                    </div>
                                                    <div className="w-full bg-gray-100 rounded-full h-2"><div className="bg-gradient-to-r from-amber-400 to-amber-600 h-2 rounded-full transition-all" style={{ width: `${maxRev > 0 ? ((rev / maxRev) * 100) : 0}%` }}></div></div>
                                                    <p className="text-[10px] text-gray-400 mt-1">{item.sold} จาน × ฿{item.price}</p>
                                                </div>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Bottom Nav */}
                    <nav className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 py-2 px-4 flex justify-around items-center z-30 max-w-lg mx-auto text-xs font-medium text-gray-400">
                        {[
                            { k: 'dashboard', icon: Home, label: 'หน้าหลัก' },
                            { k: 'orders', icon: ClipboardList, label: 'ออเดอร์', badge: newOrders },
                            { k: 'menu', icon: Utensils, label: 'เมนู' },
                            { k: 'sales', icon: BarChart3, label: 'ยอดขาย' },
                        ].map(t => (
                            <button key={t.k} onClick={() => setTab(t.k)} className={`flex flex-col items-center gap-1 transition-colors ${tab === t.k ? 'text-[#5D4037]' : 'hover:text-gray-600'}`}>
                                <div className="relative">
                                    <t.icon size={24} strokeWidth={tab === t.k ? 2.5 : 2} />
                                    {t.badge > 0 && <span className="absolute -top-1 -right-1.5 bg-red-500 text-white text-[9px] w-4 h-4 flex items-center justify-center rounded-full font-bold border-2 border-white pulse-dot">{t.badge}</span>}
                                </div>
                                {t.label}
                            </button>
                        ))}
                    </nav>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>